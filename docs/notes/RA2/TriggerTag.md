---
category:
  - RA2
  - 地图
tag:
  - 地图编辑
  - 触发
  - 标签
---

# 红红触发与标签与时序小记

在[触发逻辑：循环结构](../../archives/RA2TriggerLogics.md#_2-3-循环结构)中，我们简要提了一下触发的「重复类型」。但这个重复类型果真如字面意义上的*单次*或*重复*触发吗？在程序代码中十分自然的顺序结构，触发却需要专门打造一条链，那么触发之间到底是什么样的关系呢？

![“重复类型”](../../archives/fa2_trigger_ui.webp =50%x50%)

## 触发的时序

### 「重复类型」
首先对类型简单做个介绍。从上图可以看到，已知的触发类型有以下三种（`FA2MO`曾经给出过第四种，事实证明并不存在）：

0. **任一**（关联对象）满足（所有条件），触发**一次**
1. **所有**（关联对象）满足（所有条件），触发一次
2. 任一（关联对象）满足（所有条件），**重复**触发

::: note 关联对象
包括地图上摆着的科技类型（玩家有实感的东西，非要说就是兵坦机建）、单元标记（就是地图上的红叉叉）、作战小队。其中作战小队比较特殊。
:::

> [!warning]
> 有人可能理解上会有偏差，误认为触发用这种方式支持了逻辑或。对此，《触发逻辑》那一篇指路的视频教程里已经纠正，不妨去看看。或者用反证法实地测试一下（提示：用局部变量来设置永假条件）。

### 时序基本原则

若没有特别限定，默认的触发是**未被阻塞**（也就是地编里未勾选「禁止」触发）、**所有难度都可以执行**的。这种情况下，它**从开局就开始等待事件**（或者说判断条件），一旦有这么一个事件（组）（或者说条件（组）满足），它就执行相应的行为。

如果该触发只执行一次，则行为执行完毕时触发废止，后续也不再接受其他「允许触发」的唤醒；若是重复触发，则行为执行结束后接着等待（即循环结构）。而对于重复类型 1 - 所有满足，触发一次，情况则有点复杂。

**对于地图上预先摆着的实体，「所有满足，触发一次」就是字面意思**。好比我把指定的猴子全炸了，才出来一句「文体两开花」。但小队不同。小队当中可以不止一个成员，同样一局游戏可以有好几批同种小队。

对于**某一批**小队里的**所有成员**，「所有满足，触发一次」**字面义同样适用**，也很容易理解；但对于**不同批次**的该小队，**有多少批次触发就会执行多少次**，届时该触发实际上变成了重复触发。例子嘛，可以参考原版 RA2（不是尤里复仇）的盟军 11：核爆辐射尘，有一个经典的工程师修桥名场面。

### 强制触发
除了依照基本原则和「重复类型」执行的触发外，还有一种被称为*强制触发*的方式 ~~，类似回合制拉条~~。经过测试，强制触发的确如同字面意思一样，**会忽略该触发的事件（组），立即执行该触发的行为。**

强制触发就我个人的经验而言，**至少**需要保证该触发**未被「禁止」**。有大佬称这个行为还有其他限（暗）制（坑），因此建议还是慎用。

## 标签

从 TS 开始，上述的时序关系实际上是由标签决定的：

![鲜少关注的“标签编辑器”](./tag_editor.webp =30%x30%)

标签负责告知游戏地图上存在的触发——对于未被任何标签引用的触发，游戏认为其不存在^3^。

通常来说，标签最直接的用途是**联结触发与地图上的实例**（即上面的*关联对象*），让触发去**判定关联对象的状态**（越过区域、对象被攻击/摧毁），或者去**赋予它们状态**（摧毁目标、变卖建筑）。

Zero Fanker 认为，标签是一种传递事件的「管道」，向触发传递关联对象的状态。一旦触发成功接收到这个状态，**与管道断开了连接**，这个管道也就消亡。从这个角度出发，也可以这么说：那些未与尚存管道相连的触发，在游戏中全程空转；在用户（地图师和玩家）看来，就像是从未存在过。

::: warning 施工中
最近也是应几位大佬之邀另行开这篇小记，着重讨论一下触发与标签的一些细节。笔记还没写完，敬请期待。
:::
